<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>Spring &middot; SugarStar</title>
    <meta name="generator" content="Hugo 0.55.5" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="SugarStar">
    
      <meta name="description" content="">
    
    
    <link rel="canonical" href="https://sugarstar88.github.io/2020/06/11/spring/"/>
    <link rel="icon" href="https://sugarstar88.github.io/favicon.ico">
    <link rel="apple-touch-icon" href="https://sugarstar88.github.io/apple-touch-icon.png"/>
    <link rel="stylesheet" href="https://sugarstar88.github.io/css/style.css">
    <link rel="stylesheet" href="https://sugarstar88.github.io/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://sugarstar88.github.io/css/monokai.css">
    <link rel="stylesheet" href="https://sugarstar88.github.io/fancybox/jquery.fancybox.css">
    
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
    <meta property="og:title" content="Spring" />
<meta property="og:description" content="一、简介 主要发明者 RodJohnson
轮子理论推崇者 轮子理论：不要重复造轮子 IT行业：直接使用写好的代码
Spring框架宗旨 不重新发明技术，让原有技术使用更加方便
Spring几大核心功能  IoC/DI 控制翻转/依赖注入
 AOP 面向切面编程
 声明式事务
  Spring框架的runtime 1. Test Spring提供测试功能
2. Core Container 核心容器Spring启动的最基本条件
 Beans Spring 负责创建类对象并管理对象
 Core 核心类
 Context 上下文参数，获取外部资源或管理注解等
 SpEL expression.jar
  3. AOP 实现AOP需要依赖
4. Aspects 切面AOP依赖的包
5. Data Access/Intergration Spring封装数据访问层相关内容
 JDBC Spring对JDBC封装后的代码 ORM 封装了持久层框架的代码，例如hibernate transactions 对应spring-tx.jar，声明式事务时使用  6. Web 需要Spring完成相关功能时
 由Tomcat加载Spring配置文件时，需要spring-web  Spring框架重要概念 1. 容器（Container） Spring当做一个容器" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://sugarstar88.github.io/2020/06/11/spring/" />
<meta property="article:published_time" content="2020-06-11T15:17:12&#43;08:00"/>
<meta property="article:modified_time" content="2020-06-11T15:17:12&#43;08:00"/>

    
    
<meta itemprop="name" content="Spring">
<meta itemprop="description" content="一、简介 主要发明者 RodJohnson
轮子理论推崇者 轮子理论：不要重复造轮子 IT行业：直接使用写好的代码
Spring框架宗旨 不重新发明技术，让原有技术使用更加方便
Spring几大核心功能  IoC/DI 控制翻转/依赖注入
 AOP 面向切面编程
 声明式事务
  Spring框架的runtime 1. Test Spring提供测试功能
2. Core Container 核心容器Spring启动的最基本条件
 Beans Spring 负责创建类对象并管理对象
 Core 核心类
 Context 上下文参数，获取外部资源或管理注解等
 SpEL expression.jar
  3. AOP 实现AOP需要依赖
4. Aspects 切面AOP依赖的包
5. Data Access/Intergration Spring封装数据访问层相关内容
 JDBC Spring对JDBC封装后的代码 ORM 封装了持久层框架的代码，例如hibernate transactions 对应spring-tx.jar，声明式事务时使用  6. Web 需要Spring完成相关功能时
 由Tomcat加载Spring配置文件时，需要spring-web  Spring框架重要概念 1. 容器（Container） Spring当做一个容器">


<meta itemprop="datePublished" content="2020-06-11T15:17:12&#43;08:00" />
<meta itemprop="dateModified" content="2020-06-11T15:17:12&#43;08:00" />
<meta itemprop="wordCount" content="1267">



<meta itemprop="keywords" content="" />

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Spring"/>
<meta name="twitter:description" content="一、简介 主要发明者 RodJohnson
轮子理论推崇者 轮子理论：不要重复造轮子 IT行业：直接使用写好的代码
Spring框架宗旨 不重新发明技术，让原有技术使用更加方便
Spring几大核心功能  IoC/DI 控制翻转/依赖注入
 AOP 面向切面编程
 声明式事务
  Spring框架的runtime 1. Test Spring提供测试功能
2. Core Container 核心容器Spring启动的最基本条件
 Beans Spring 负责创建类对象并管理对象
 Core 核心类
 Context 上下文参数，获取外部资源或管理注解等
 SpEL expression.jar
  3. AOP 实现AOP需要依赖
4. Aspects 切面AOP依赖的包
5. Data Access/Intergration Spring封装数据访问层相关内容
 JDBC Spring对JDBC封装后的代码 ORM 封装了持久层框架的代码，例如hibernate transactions 对应spring-tx.jar，声明式事务时使用  6. Web 需要Spring完成相关功能时
 由Tomcat加载Spring配置文件时，需要spring-web  Spring框架重要概念 1. 容器（Container） Spring当做一个容器"/>

    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
</head>
<body>
<div class="container">


<div id="container">
	<header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="https://sugarstar88.github.io/" id="logo">
          
          <i class="logo" style="background-image: url('https://sugarstar88.github.io/css/images/logo.png')"></i>
          
          <span class="site-title">SugarStar</span>
      </a>
      <nav id="main-nav">
          
          
          <a class="main-nav-link" href="https://sugarstar88.github.io/">主页</a>
          
          
          
          
          
          

          

          
          
          
          
          <a class="main-nav-link" href="https://sugarstar88.github.io/tags/">标签</a>
          
          
          
          <a class="main-nav-link" href="https://sugarstar88.github.io/categories/">目录分类</a>
          
          
      </nav>
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="https://sugarstar88.github.io/css/images/SugarStar.jpg"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
              <input type="search" name="q" class="search-form-input" placeholder="搜索">
              <button type="submit" class="search-form-submit">
              </button>
              <input type="hidden" name="sitesearch" value="https://sugarstar88.github.io/" />
         </form>
        </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tbody>
          <tr>
          
          
          <td><a class="main-nav-link" href="https://sugarstar88.github.io/">主页</a></td>
          
          
          
          
          
          

          

          
          
          
          
          <td><a class="main-nav-link" href="https://sugarstar88.github.io/tags/">标签</a></td>
          
          
          
          <td><a class="main-nav-link" href="https://sugarstar88.github.io/categories/">目录分类</a></td>
          
          
          <td>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
          <input type="search" name="q" class="search-form-input" placeholder="Search">
          <input type="hidden" name="sitesearch" value="https://sugarstar88.github.io/" />
          </form>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</header>

   	
   	<div class="outer">
   	
    	<aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      
      <img id="avatar" src="https://sugarstar88.github.io/css/images/SugarStar.jpg">
      
      <h2 id="name">SugarStar</h2>
      <h3 id="title">程序员</h3>
      <span id="location"><i class="fa fa-map-marker"></i>江苏·南京</span>
      
          <a id="follow" href="https://github.com/SugarStars">
              关注
          </a>
      
    </div>
    <div class="article-info profile-block">
      <div class="article-info-block">
        3
        <span>文章</span>
      </div>
      <div class="article-info-block">
        
          0
        
        <span>
            标签
        </span>
      </div>
    </div>
    <div class="profile-block social-links">
      <table>
        <tr>
          
<td><a href="//github.com/SugarStars" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>




















































          <td><a href="https://sugarstar88.github.io/index.xml" target="_blank" title="RSS"><i class="fa fa-rss"></i></a></td>
        </tr>
      </table>
    </div>
  </div>
</aside>

    

    <section id="main">
    
    <article id="page-undefined" class="article article-type-page" itemscope="" itemprop="blogPost">
    <div class="article-inner">
        

        <header class="article-header">
    <a href="https://sugarstar88.github.io/2020/06/11/spring/">
    <h1 class="article-title" itemprop="name">
        Spring
    </h1>
    </a>
    <div class="article-meta">

        
        <div class="article-date">
            <i class="fa fa-calendar"></i>
            <time datetime="2020-06-11 15:17:12 &#43;0800 CST" itemprop="datePublished">2020-06-11</time>
            &middot;
            1267
            
            &middot;
            6
            次阅读
        </div>
        
        

        
    </div>
</header>

        <div class="article-entry" itemprop="articleBody">
            

<h1 id="一-简介">一、简介</h1>

<h2 id="主要发明者">主要发明者</h2>

<p>RodJohnson</p>

<h2 id="轮子理论推崇者">轮子理论推崇者</h2>

<p>轮子理论：不要重复造轮子
IT行业：直接使用写好的代码</p>

<h2 id="spring框架宗旨">Spring框架宗旨</h2>

<p>不重新发明技术，让原有技术使用更加方便</p>

<h2 id="spring几大核心功能">Spring几大核心功能</h2>

<ul>
<li><p>IoC/DI        控制翻转/依赖注入</p></li>

<li><p>AOP               面向切面编程</p></li>

<li><p>声明式事务</p></li>
</ul>

<h2 id="spring框架的runtime">Spring框架的runtime</h2>

<p><img src="https://cdn.jsdelivr.net/gh/sugarstar88/imgHosting/ITRHX-PIC/1577635635510.png" alt="Spring Framework Runtime" /></p>

<h3 id="1-test">1. Test</h3>

<p>Spring提供测试功能</p>

<h3 id="2-core-container">2. Core Container</h3>

<p>核心容器Spring启动的最基本条件</p>

<ul>
<li><p>Beans Spring 负责创建类对象并管理对象</p></li>

<li><p>Core 核心类</p></li>

<li><p>Context 上下文参数，获取外部资源或管理注解等</p></li>

<li><p>SpEL expression.jar</p></li>
</ul>

<h3 id="3-aop">3.  AOP</h3>

<p>实现AOP需要依赖</p>

<h3 id="4-aspects">4.  Aspects</h3>

<p>切面AOP依赖的包</p>

<h3 id="5-data-access-intergration">5. Data Access/Intergration</h3>

<p>Spring封装数据访问层相关内容</p>

<ul>
<li>JDBC Spring对JDBC封装后的代码</li>
<li>ORM 封装了持久层框架的代码，例如hibernate</li>
<li>transactions 对应spring-tx.jar，声明式事务时使用</li>
</ul>

<h3 id="6-web">6. Web</h3>

<p>需要Spring完成相关功能时</p>

<ul>
<li>由Tomcat加载Spring配置文件时，需要spring-web</li>
</ul>

<h2 id="spring框架重要概念">Spring框架重要概念</h2>

<h3 id="1-容器-container">1. 容器（Container）</h3>

<p>Spring当做一个容器</p>

<h3 id="2-beanfactory接口">2.  BeanFactory接口</h3>

<ul>
<li><p>老版本BeanFactory</p></li>

<li><p>新版本中ApplicationContext接口是BeanFactory的子接口</p></li>
</ul>

<h2 id="从spring3开始把spring功能拆分成多个jar">从Spring3开始把Spring功能拆分成多个jar</h2>

<ul>
<li>Spring2以前就一个jar</li>
</ul>

<h1 id="二-ioc">二、IoC</h1>

<p>控制反转（Inversion of Control，缩写为IoC）</p>

<h2 id="作用">作用</h2>

<p>由程序员主动new对象转交给Spring负责
- 控制类对象</p>

<ul>
<li><p>反转交给Spring负责</p></li>

<li><p>解耦 不需要程序员管理对象</p></li>
</ul>

<h1 id="三-环境搭建">三、环境搭建</h1>

<h2 id="1-导入jar">1. 导入jar</h2>

<ul>
<li>spring-beans-4.1.6.RELEASE.jar</li>
<li>spring-core-4.1.6.RELEASE.jar</li>
<li>spring-context-4.1.6.RELEASE.jar</li>
<li>spring-expression-4.1.6.RELEASE.jar</li>
<li>commons-logging-1.1.3.jar</li>
</ul>

<h2 id="2-在src下新建applicationcontext-xml">2. 在src下新建applicationContext.xml</h2>

<ul>
<li>文件名和路径自定义</li>
<li><code>applicationContext.xml</code>中的信息最终会被读取到ApplicationContext容器中</li>
<li>spring配置文件是基于schema

<ul>
<li>schema文件扩展名.xsd</li>
<li>schema是DTD的升级版，比DTD具有更好的扩展性</li>
<li>每次引入一个xsd文件是一个namespace(xmlns)</li>
</ul></li>

<li><p>配置文件只需引入schema基本schema</p>

<ul>
<li>通过<bean/>创建对象</li>

<li><p>默认配置文件被加载时创建对象</p>

<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;
&lt;bean id=&quot;peo&quot; class=&quot;com.sugar.People&quot;&gt;&lt;/bean&gt;
&lt;/beans&gt;
</code></pre>

<pre><code class="language-java">ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);
People bean = ac.getBean(&quot;peo&quot;, People.class);
</code></pre></li>
</ul></li>
</ul>

<h1 id="四-spring创建对象的三种方式">四、Spring创建对象的三种方式</h1>

<h2 id="通过构造方法创建">通过构造方法创建</h2>

<ul>
<li>无参构造创建 默认情况</li>
<li>有参构造创建 需要明确配置

<ul>
<li>需要在类中提供有参构造方法</li>
<li>在applicationContext.xml中设置调用哪个构造方法

<ul>
<li>若设定条件匹配到多个构造方法，则执行最后的构造方法进行创建</li>
</ul></li>
</ul></li>
</ul>

<pre><code class="language-java">public class People {
	
	private String name;
	private int id;
	
	public People(String name, int id) {
		super();
		this.name = name;
		this.id = id;
	}	
	public People(int id, String name) {
		super();
		this.name = name;
		this.id = id;
	}
	public String getName() {
		return name;
	}
	public void setName(String name) {
		this.name = name;
	}
	public int getId() {
		return id;
	}
	public void setId(int id) {
		this.id = id;
	}
	@Override
	public String toString() {
		return &quot;People [name=&quot; + name + &quot;, id=&quot; + id + &quot;]&quot;;
	}
}
</code></pre>

<pre><code class="language-xml">&lt;bean id=&quot;peo&quot; class=&quot;com.sugar.People&quot;&gt;
    &lt;!-- ref 表示引用另外一个Bean   value表示基本数据类型或字符串等 --&gt;
    &lt;constructor-arg index=&quot;0&quot; name=&quot;name&quot; type=&quot;java.lang.String&quot; value=&quot;张三&quot;&gt;&lt;/constructor-arg&gt;
    &lt;constructor-arg index=&quot;1&quot; name=&quot;id&quot; type=&quot;int&quot; value=&quot;1&quot;&gt;&lt;/constructor-arg&gt;
&lt;/bean&gt;
</code></pre>

<h2 id="实例工厂创建">实例工厂创建</h2>

<ul>
<li>工厂设计模式，帮助创建类对象，一个工厂可以创建多个对象</li>
<li>实例工厂，需要先创建工厂才能产生对象</li>
</ul>

<pre><code class="language-xml">&lt;bean id=&quot;factory&quot; class=&quot;com.sugar.PeopleFactory&quot;&gt;&lt;/bean&gt;
&lt;bean id=&quot;peo&quot; factory-bean=&quot;factory&quot; factory-method=&quot;newInstance&quot;&gt;&lt;/bean&gt;
</code></pre>

<h2 id="静态工厂创建">静态工厂创建</h2>

<ul>
<li><p>静态工厂，不需要创建工厂，能快速创建对象</p>

<pre><code class="language-xml">&lt;bean id=&quot;peo&quot; class=&quot;com.sugar.PeopleFactory&quot; factory-method=&quot;newInstance&quot;&gt;&lt;/bean&gt;
</code></pre>

<h1 id="五-给bean的属性赋值-注入">五、给Bean的属性赋值（注入）</h1>

<h2 id="设置属性值2种方式">设置属性值2种方式</h2>

<ul>
<li>通过构造方法设置值</li>
<li>设置注入（通过set方法）</li>
</ul>

<h2 id="设置注入实现方式">设置注入实现方式</h2>

<h3 id="1-属性为基本数据类型或string等简单数据类型">1. 属性为基本数据类型或String等简单数据类型</h3>

<pre><code class="language-xml">&lt;bean id=&quot;peo&quot; class=&quot;com.sugar.People&quot;&gt;
&lt;property name=&quot;id&quot; value=&quot;123&quot;&gt;&lt;/property&gt;  
&lt;property name=&quot;name&quot; value=&quot;张三&quot;&gt;&lt;/property&gt;  
&lt;/bean&gt;
</code></pre></li>
</ul>

<p>等效于</p>

<pre><code class="language-xml">&lt;bean id=&quot;peo&quot; class=&quot;com.sugar.People&quot;&gt;
    &lt;property name=&quot;id&quot;&gt;
    	&lt;value&gt;123&lt;/value&gt;
    &lt;/property&gt;  
    &lt;property name=&quot;name&quot;&gt;
    	&lt;value&gt;张三&lt;/value&gt;
    &lt;/property&gt;  
&lt;/bean&gt;
</code></pre>

<h3 id="2-属性为set">2. 属性为Set&lt;?&gt;</h3>

<pre><code class="language-xml">&lt;bean id=&quot;peo&quot; class=&quot;com.sugar.People&quot;&gt;
    &lt;property name=&quot;peopleSet&quot;&gt;
        &lt;set&gt;
            &lt;value&gt;1&lt;/value&gt;
            &lt;value&gt;2&lt;/value&gt;
            &lt;value&gt;3&lt;/value&gt;
        &lt;/set&gt;
    &lt;/property&gt;
&lt;/bean&gt;
</code></pre>

<h3 id="3-属性为list">3. 属性为List&lt;?&gt;</h3>

<pre><code class="language-xml">&lt;bean id=&quot;peo&quot; class=&quot;com.sugar.People&quot;&gt;
    &lt;property name=&quot;peopleList&quot;&gt;
        &lt;list&gt;
            &lt;value&gt;1&lt;/value&gt;
            &lt;value&gt;2&lt;/value&gt;
            &lt;value&gt;3&lt;/value&gt;
        &lt;/list&gt;
    &lt;/property&gt;
&lt;/bean&gt;
</code></pre>

<p>若list属性中只有一个value</p>

<pre><code class="language-xml">&lt;bean id=&quot;peo&quot; class=&quot;com.sugar.People&quot;&gt;
    &lt;property name=&quot;peopleList&quot; value=&quot;1&quot;&gt;&lt;/property&gt;
&lt;/bean&gt;
</code></pre>

<h3 id="4-属性是数组">4. 属性是数组</h3>

<pre><code class="language-xml">&lt;bean id=&quot;peo&quot; class=&quot;com.sugar.People&quot;&gt;
    &lt;property name=&quot;peopleArray&quot;&gt;
        &lt;array&gt;
            &lt;value&gt;1&lt;/value&gt;
            &lt;value&gt;2&lt;/value&gt;
            &lt;value&gt;3&lt;/value&gt;
        &lt;/array&gt;
    &lt;/property&gt;
&lt;/bean&gt;
</code></pre>

<p>若数组中只有一个值时，可直接通过value属性赋值</p>

<h3 id="5-属性是map">5. 属性是map</h3>

<pre><code class="language-xml">&lt;bean id=&quot;peo&quot; class=&quot;com.sugar.People&quot;&gt;
    &lt;property name=&quot;peopleMap&quot;&gt;
        &lt;map&gt;
            &lt;entry key=&quot;username&quot; value=&quot;zhangsan&quot;&gt;&lt;/entry&gt;
            &lt;entry key=&quot;password&quot; value=&quot;123&quot;&gt;&lt;/entry&gt;
        &lt;/map&gt;
    &lt;/property&gt;
&lt;/bean&gt;
</code></pre>

<h3 id="6-属性是properties">6. 属性是properties</h3>

<pre><code class="language-xml">&lt;bean id=&quot;peo&quot; class=&quot;com.sugar.People&quot;&gt;
    &lt;property name=&quot;peopleProperty&quot;&gt;
        &lt;props&gt;
            &lt;prop key=&quot;key1&quot;&gt;123&lt;/prop&gt;
            &lt;prop key=&quot;key2&quot;&gt;456&lt;/prop&gt;
        &lt;/props&gt;
    &lt;/property&gt;
&lt;/bean&gt;
</code></pre>

<h1 id="六-di">六、DI</h1>

<h2 id="di的定义">DI的定义</h2>

<p>依赖注入（Dependency Injection，缩写为DI）</p>

<p>DI和Ioc是一样的，当一个类A需要依赖另一个B对象时，把另一个对象B赋值给A对象的过程叫做依赖注入</p>

<pre><code class="language-xml">&lt;bean id=&quot;desk&quot; class=&quot;com.sugar.Desk&quot;&gt;&lt;/bean&gt; 
&lt;bean id=&quot;peo&quot; class=&quot;com.sugar.People&quot;&gt;
	&lt;property name=&quot;peopleDesk&quot; ref=&quot;desk&quot;&gt;&lt;/property&gt;
&lt;/bean&gt;
</code></pre>

<h1 id="七-使用spring简化mybatis">七、使用Spring简化Mybatis</h1>

<h2 id="1-导入jar-1">1. 导入jar</h2>

<ul>
<li>asm-3.3.1.jar</li>
<li>cglib-2.2.2.jar</li>
<li>commons-logging-1.1.1.jar</li>
<li>commons-logging-1.1.3.jar</li>
<li>javassist-3.17.1-GA.jar</li>
<li>log4j-1.2.17.jar</li>
<li>log4j-api-2.0-rc1.jar</li>
<li>log4j-core-2.0-rc1.jar</li>
<li>mybatis-3.2.7.jar</li>
<li>mybatis-spring-1.2.3.jar</li>
<li>ojdbc14-10.2.0.1.0.jar</li>
<li>slf4j-api-1.7.5.jar</li>
<li>slf4j-log4j12-1.7.5.jar</li>
<li>spring-aop-4.1.6.RELEASE.jar</li>
<li>spring-beans-4.1.6.RELEASE.jar</li>
<li>spring-context-4.1.6.RELEASE.jar</li>
<li>spring-core-4.1.6.RELEASE.jar</li>
<li>spring-expression-4.1.6.RELEASE.jar</li>
<li>spring-jdbc-4.1.6.RELEASE.jar</li>
<li>spring-tx-4.1.6.RELEASE.jar</li>
</ul>

<h2 id="2-编写applicationcontext-xml文件">2. 编写applicationContext.xml文件</h2>

<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;
    &lt;!-- 数据源封装类, 数据源:获取数据源连接 spring-jdbc.jar中--&gt;
	&lt;bean id=&quot;dataSource&quot; class=&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;&gt;
		&lt;property name=&quot;driverClassName&quot; value=&quot;oracle.jdbc.driver.OracleDriver&quot;&gt;&lt;/property&gt;
		&lt;property name=&quot;url&quot; value=&quot;jdbc:oracle:thin:@localhost:1521:orcl&quot;&gt;&lt;/property&gt;
		&lt;property name=&quot;username&quot; value=&quot;TX_USER&quot;&gt;&lt;/property&gt;
		&lt;property name=&quot;password&quot; value=&quot;TX_USER&quot;&gt;&lt;/property&gt;
	&lt;/bean&gt;
	&lt;!-- 创建SqlSessionFactory对象 --&gt;
	&lt;bean id=&quot;factory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;
		&lt;!-- 数据库信息来源于DataSources --&gt;
		&lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;&gt;&lt;/property&gt;
	&lt;/bean&gt;
	&lt;!-- 扫描器相当于Mybatis.xml中mappers下的package标签, 扫描包后会给对应接口创建对象 --&gt;
	&lt;bean class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt;
		&lt;!-- 需要扫描的包 --&gt;
		&lt;property name=&quot;sqlSessionFactory&quot; ref=&quot;factory&quot;&gt;&lt;/property&gt;
		&lt;!-- 和SqlSessionFactory建立联系 --&gt;
		&lt;property name=&quot;basePackage&quot; value=&quot;com.sugar.mapper&quot;&gt;&lt;/property&gt;
	&lt;/bean&gt;
	
	&lt;!-- 由Spring管理Service实现类 --&gt;
	&lt;bean id=&quot;flowerService&quot; class=&quot;com.sugar.service.impl.FlowerServiceImpl&quot;&gt;
		&lt;!-- 将已经通过basePackage扫描创建的mapper对象，通过set方法注入到对应Service --&gt;
		&lt;property name=&quot;flowerMapper&quot; ref=&quot;flowerMapper&quot;&gt;&lt;/property&gt;
	&lt;/bean&gt;
&lt;/beans&gt;
</code></pre>

<h2 id="3-编写正常代码">3. 编写正常代码</h2>

<ul>
<li>正常编写pojo</li>
<li>编写mapper包必须用接口绑定或注解方案(必须有接口)</li>
<li>编写Service接口及实现类

<ul>
<li>需要在接口中声明mapper，同时具备get/set方法</li>
</ul></li>
<li>Spring无法管理servlet</li>
</ul>

<h1 id="八-aop">八、AOP</h1>

<h2 id="aop的定义">AOP的定义</h2>

<p>面向切面编程（Aspect Oriented Programming，简称AOP）</p>

<h2 id="执行流程">执行流程</h2>

<ul>
<li><p>在原先纵向执行流程，添加横切面</p></li>

<li><p>无需修改原有代码，体现程序高扩展性</p></li>
</ul>

<p><img src="https://cdn.jsdelivr.net/gh/sugarstar88/imgHosting/ITRHX-PIC/aop.png" alt="aop" /></p>

<h2 id="面向切面编程是什么">面向切面编程是什么？</h2>

<p>在原有纵向执行流程中，针对某一个方法或某一些方法添加通知，形成横切面过程，叫做面向切面编程。</p>

<h2 id="常用概念">常用概念</h2>

<ul>
<li>切点，原有功能 cutpoint</li>
<li>前置通知，在切点之前执行的功能 before advice</li>
<li>后置通知，再切点之后执行的功能 after advice</li>
<li>异常通知，切点过程中出现异常，触发异常通知 throws advice</li>
<li>切面，所有功能总称</li>
<li>织入，把切面嵌入到原有功能的过程</li>
</ul>

<h2 id="spring提供了2种aop实现方式">Spring提供了2种AOP实现方式</h2>

<h3 id="1-schema-based">1. Schema-based</h3>

<ul>
<li>每个通知都需要实现接口或类</li>
<li>配置spring配置文件时在<code>&lt;aop:config&gt;</code>中配置</li>
</ul>

<h3 id="2-aspectj">2. Aspectj</h3>

<ul>
<li><p>每个通知不需要实现接口或类</p></li>

<li><p>配置spring配置文件时在<code>&lt;aop:config&gt;</code>的字标签<code>&lt;aop:aspect&gt;</code>中配置</p></li>
</ul>

<h2 id="配置前置通知-后置通知-schema-based方式">配置前置通知、后置通知（Schema-based方式）</h2>

<h3 id="1-导入jar包">1. 导入jar包</h3>

<ul>
<li>aopalliance.jar</li>
<li>aspectjweaver.jar</li>
<li>commons-logging-1.1.3.jar</li>
<li>spring-aop-4.1.6.RELEASE.jar</li>
<li>spring-aspects-4.1.6.RELEASE.jar</li>
<li>spring-beans-4.1.6.RELEASE.jar</li>
<li>spring-context-4.1.6.RELEASE.jar</li>
<li>spring-core-4.1.6.RELEASE.jar</li>
<li>spring-expression-4.1.6.RELEASE.jar</li>
<li>spring-tx-4.1.6.RELEASE.jar</li>
</ul>

<h3 id="2-新建通知类">2. 新建通知类</h3>

<ul>
<li>前置通知类</li>
</ul>

<pre><code class="language-java">public class MyBeforeAdvice implements MethodBeforeAdvice{

	@Override
	public void before(Method arg0, Object[] arg1, Object arg2) throws Throwable {
		System.out.println(&quot;执行前置通知！&quot;);
	}

}
</code></pre>

<ul>
<li>后置通知类

<ul>
<li>arg0 切点方法的返回值</li>
<li>arg1 切点方法对象</li>
<li>arg2 切点方法参数</li>
<li>arg3 切点方法所在类的对象</li>
</ul></li>
</ul>

<pre><code class="language-java">public class MyAfterAdvice implements AfterReturningAdvice{

	@Override
	public void afterReturning(Object arg0, Method arg1, Object[] arg2, Object arg3) throws Throwable {
		System.out.println(&quot;执行后置通知！&quot;);
	}

}
</code></pre>

<h3 id="3-配置spring配置文件">3. 配置Spring配置文件</h3>

<ul>
<li>引入aop命名空间</li>
<li>配置通知类的bean</li>
<li>配置切面</li>
<li>*   通配符，匹配任意方法名，任意类名，任意一级包</li>

<li><p>如果希望匹配任意方法参数   {..}</p>

<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
	xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;
	xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans.xsd
   	http://www.springframework.org/schema/aop
    http://www.springframework.org/schema/aop/spring-aop.xsd&quot;&gt;
&lt;!-- 配置通知类对象, 在切面中需要引入 --&gt;
	&lt;bean id=&quot;myBeforeAdvice&quot; class=&quot;com.sugar.MyBeforeAdvice&quot;&gt;&lt;/bean&gt;
	&lt;bean id=&quot;myAfterAdvice&quot; class=&quot;com.sugar.MyAfterAdvice&quot;&gt;&lt;/bean&gt;
	&lt;!-- 配置切面 --&gt;
	&lt;aop:config&gt;
		&lt;!-- 配置切点 --&gt;
		&lt;!-- 方法含有参数 示例: expression=&quot;execution(* com.sugar.Demo.demo2(String, int)) and args(name, age)  --&gt;
		&lt;aop:pointcut expression=&quot;execution(* com.sugar.Demo.demo2())&quot; id=&quot;mypoint&quot; /&gt;
		&lt;!-- 通知 --&gt;
		&lt;aop:advisor advice-ref=&quot;myBeforeAdvice&quot; pointcut-ref=&quot;mypoint&quot;/&gt;
		&lt;aop:advisor advice-ref=&quot;myAfterAdvice&quot; pointcut-ref=&quot;mypoint&quot;/&gt;
	&lt;/aop:config&gt;
	&lt;!-- 配置Demo类, 测试使用 --&gt;
	&lt;bean id=&quot;demo&quot; class=&quot;com.sugar.Demo&quot;&gt;&lt;/bean&gt;
&lt;/beans&gt;
</code></pre>

<h3 id="4-编写测试代码">4. 编写测试代码</h3>

<pre><code class="language-java">public static void main(String[] args) {
		ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);
		Demo demo = ac.getBean(&quot;demo&quot;, Demo.class);
		demo.demo1();
		demo.demo2();
		demo.demo3();
	}
</code></pre></li>
</ul>

<h3 id="5-运行结果">5. 运行结果</h3>

<pre><code>demo1
执行前置通知！
demo2
执行后置通知！
demo3
</code></pre>

<h2 id="配置异常通知-schema-based方式">配置异常通知（Schema-based方式）</h2>

<h3 id="1-新建一个类-实现throwsadvice接口">1.  新建一个类，实现ThrowsAdvice接口</h3>

<ul>
<li><p>必须自己写方法，且必须叫afterThrowing</p></li>

<li><p>两种参数方式，必须为一个或四个</p></li>

<li><p>异常类型要与切点报的类型一致</p></li>
</ul>

<pre><code class="language-java">public class MyThrowsAdvice implements ThrowsAdvice{
	
	public void afterThrowing(Exception e1) {
		System.out.println(&quot;执行异常通知 Schema-based&quot; + e1.getMessage());
	}
	
}
</code></pre>

<h3 id="2-配置applicationcontext-xml">2. 配置applicationContext.xml</h3>

<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
	xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;
	xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
       	http://www.springframework.org/schema/aop
        http://www.springframework.org/schema/aop/spring-aop.xsd&quot;&gt;
	
	&lt;bean id=&quot;myThrows&quot; class=&quot;com.sugar.MyThrowsAdvice&quot;&gt;&lt;/bean&gt;
	&lt;aop:config&gt;
		&lt;aop:pointcut expression=&quot;execution(* com.sugar.Demo.demo1())&quot; id=&quot;mypoint&quot;/&gt;
		&lt;aop:advisor advice-ref=&quot;myThrows&quot; pointcut-ref=&quot;mypoint&quot;/&gt;
	&lt;/aop:config&gt;
	
	&lt;bean id=&quot;demo&quot; class=&quot;com.sugar.Demo&quot;&gt;&lt;/bean&gt;
	
&lt;/beans&gt;
</code></pre>

<h2 id="配置环绕通知-schema-based方式">配置环绕通知（Schema-based方式）</h2>

<p>把前置通知和后置通知都写到一个通知中，就组成了环绕通知</p>

<p>实现步骤</p>

<h3 id="1-新建一个类-实现methodinterceptor接口">1. 新建一个类，实现MethodInterceptor接口</h3>

<pre><code class="language-java">public class MyArroundAdvice implements MethodInterceptor{

	@Override
	public Object invoke(MethodInvocation arg0) throws Throwable {
		System.out.println(&quot;环绕-前置&quot;);
		Object result = arg0.proceed();
		System.out.println(&quot;环绕-后置&quot;);
		return result;
	}

}
</code></pre>

<h3 id="2-配置applicationcontext-xml-1">2. 配置applicationContext.xml</h3>

<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
	xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;
	xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
       	http://www.springframework.org/schema/aop
        http://www.springframework.org/schema/aop/spring-aop.xsd&quot;&gt;
	
	&lt;bean id=&quot;myArround&quot; class=&quot;com.sugar.MyArroundAdvice&quot;&gt;&lt;/bean&gt;
	&lt;aop:config&gt;
		&lt;aop:pointcut expression=&quot;execution(* com.sugar.Demo.demo1())&quot; id=&quot;mypoint&quot;/&gt;
		&lt;aop:advisor advice-ref=&quot;myArround&quot; pointcut-ref=&quot;mypoint&quot;/&gt;
	&lt;/aop:config&gt;
	
	&lt;bean id=&quot;demo&quot; class=&quot;com.sugar.Demo&quot;&gt;&lt;/bean&gt;
	
&lt;/beans&gt;
</code></pre>

<h2 id="配置前置通知-后置通知-环绕通知-异常通知-aspectj方式">配置前置通知、后置通知、环绕通知、异常通知（AspectJ方式）</h2>

<p>实现步骤</p>

<h3 id="1-新建类-方法名任意">1.新建类，方法名任意</h3>

<pre><code class="language-java">public class MyAdvice {
	public void myBefore(String name1, int age1) {
		System.out.println(&quot;前置通知&quot; + &quot;name:&quot; + name1 + &quot;, age:&quot; + age1);
	}
	public void myAfter() {
		System.out.println(&quot;后置通知&quot;);
	}
	public void myAftering() {
		System.out.println(&quot;后置通知after-returning&quot;);
	}
	public void myThrows() {
		System.out.println(&quot;异常通知通知&quot;);
	}
	public Object myArround(ProceedingJoinPoint p) throws Throwable {
		System.out.println(&quot;执行环绕&quot;);
		System.out.println(&quot;环绕-前置&quot;);
		Object result = p.proceed();
		System.out.println(&quot;环绕-后置&quot;);
		return result;
	}
}
</code></pre>

<h3 id="2-配置applicationcontext-xml-2">2.配置ApplicationContext.xml</h3>

<ul>
<li><p><code>&lt;aop:after/&gt;</code>是否出现异常都执行</p></li>

<li><p><code>&lt;aop:after-returning/&gt;</code>当切点正确执行时才会执行</p></li>

<li><p><code>&lt;aop:after/&gt;</code>、<code>&lt;aop:after-returning/&gt;</code>和<code>&lt;aop:after-throwing/&gt;</code>执行顺序和配置顺序有关</p></li>

<li><p>expression() 括号不能括上 args</p></li>

<li><p>中间使用and不可使用&amp;&amp;，由spring把and解析成&amp;&amp;</p></li>

<li><p>args(名称)名称是自定义的，顺序和demo1(参数, 参数)对应</p></li>

<li><p><code>&lt;aop:before/&gt;</code>中arg-names=&ldquo;名称&rdquo;，名称来源于expression=&ldquo;&ldquo;中的args,</p></li>
</ul>

<p>名称必须一样，args()里面有几个参数，arg-names也必须有几个参数，arg-names=&ldquo;&rdquo;</p>

<p>里面名称必须和通知方法参数名对应</p>

<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
	xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;
	xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
       	http://www.springframework.org/schema/aop
        http://www.springframework.org/schema/aop/spring-aop.xsd&quot;&gt;
	&lt;bean id=&quot;myAdvice&quot; class=&quot;com.sugar.MyAdvice&quot;&gt;&lt;/bean&gt;
	&lt;aop:config&gt;
		&lt;aop:aspect ref=&quot;myAdvice&quot;&gt;
			&lt;aop:pointcut expression=&quot;execution(* com.sugar.Demo.demo1(String, int)) and args(name1, age1)&quot; id=&quot;mypoint&quot;/&gt;
			&lt;aop:before method=&quot;myBefore&quot; pointcut-ref=&quot;mypoint&quot; arg-names=&quot;name1, age1&quot;/&gt;
			&lt;aop:after method=&quot;myAfter&quot; pointcut-ref=&quot;mypoint&quot;/&gt;
			&lt;aop:after-returning method=&quot;myAftering&quot; pointcut-ref=&quot;mypoint&quot;/&gt;
			&lt;aop:after-throwing method=&quot;myThrows&quot; pointcut-ref=&quot;mypoint&quot;/&gt; 
			&lt;aop:around method=&quot;myArround&quot; pointcut-ref=&quot;mypoint&quot;/&gt;
		&lt;/aop:aspect&gt;
	&lt;/aop:config&gt;
	&lt;bean id=&quot;demo&quot; class=&quot;com.sugar.Demo&quot;&gt;&lt;/bean&gt;
	
&lt;/beans&gt;
</code></pre>

<h2 id="配置异常通知-aspectj方式">配置异常通知（AspectJ方式）</h2>

<p>只有当切点报异常才能出发异常通知</p>

<p>在Spring有在AspectJ方式提供了异常通知的方法</p>

<ul>
<li>如果希望通过Schema-based实现需要按照特定的要求自己编写方法

<br /></li>
</ul>

<p>实现步骤</p>

<h3 id="1-新建类在类中写任意名称方法">1. 新建类在类中写任意名称方法</h3>

<pre><code class="language-java">public class MyThrowsAdvice {	
	public void myException(Exception e1) {
		System.out.println(&quot;执行异常通知！&quot; + e1.getMessage());
	}
}
</code></pre>

<h3 id="2-在spring配置文件中配置">2. 在Spring配置文件中配置</h3>

<ul>
<li><code>&lt;aop:aspect&gt;</code>的ref属性表示方法在哪个类中</li>
<li><code>&lt;aop:xxx/&gt;</code>表示什么通知</li>
<li>method，当触发通知时调用哪个方法</li>
<li>throwing，异常对象名必须和通知中方法参数名相同（可以不在通知中声明异常对象）</li>
</ul>

<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
	xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;
	xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
       	http://www.springframework.org/schema/aop
        http://www.springframework.org/schema/aop/spring-aop.xsd&quot;&gt;
	
	&lt;bean id=&quot;myThrows&quot; class=&quot;com.sugar.MyThrowsAdvice&quot;&gt;&lt;/bean&gt;
	&lt;aop:config&gt;
		&lt;aop:pointcut expression=&quot;execution(* com.sugar.Demo.demo1())&quot; id=&quot;mypoint&quot;/&gt;
		&lt;aop:aspect ref=&quot;myThrows&quot;&gt;
			&lt;aop:after-throwing method=&quot;myException&quot; pointcut-ref=&quot;mypoint&quot; throwing=&quot;e1&quot;/&gt;
		&lt;/aop:aspect&gt;
	&lt;/aop:config&gt;
	
	&lt;!-- 配置Demo类, 测试使用 --&gt;
	&lt;bean id=&quot;demo&quot; class=&quot;com.sugar.Demo&quot;&gt;&lt;/bean&gt;
	
&lt;/beans&gt;
</code></pre>

<h2 id="使用注解实现-基于aspect">使用注解实现（基于Aspect）</h2>

<p>Spring不会自动寻找注解，必须告诉Spring哪些包下可能有注解</p>

<ul>
<li><p>引入xmlns:context</p></li>

<li><p>@Component 相当于<code>&lt;bean/&gt;</code>，若没有参数则默认首字母小写</p></li>
</ul>

<p>实现步骤</p>

<h3 id="1-在spring配置文件中设置注解在那些包中">1. 在spring配置文件中设置注解在那些包中</h3>

<pre><code class="language-xml">   &lt;context:component-scan base-package=&quot;com.sugar&quot;&gt;&lt;/context:component-scan&gt;
</code></pre>

<h3 id="2-在demo中添加-component注解">2.在Demo中添加@Component注解</h3>

<h3 id="3-在方法上添加-pointcut-定义切点">3.在方法上添加@Pointcut(&ldquo;&rdquo;)，定义切点</h3>

<pre><code class="language-java">@Component
public class Demo {
	
	@Pointcut(&quot;execution(* com.sugar.Demo.demo1())&quot;)
	public void demo1() {
//		int a =  1/0;
		System.out.println(&quot;demo1&quot;);
	}
	
}
</code></pre>

<h3 id="4-在通知类中配置">4. 在通知类中配置</h3>

<ul>
<li>@Component被Spring管理</li>
<li>@Aspect相当于<code>&lt;aop:aspect/&gt;</code>表示通知方法在当前类中</li>
</ul>

<pre><code class="language-java">@Component
@Aspect
public class MyAdvice {
	
	@Before(&quot;com.sugar.Demo.demo1()&quot;)
	public void myBefore() {
		System.out.println(&quot;前置通知&quot;);
	}
	
	@After(&quot;com.sugar.Demo.demo1()&quot;)
	public void myAfter() {
		System.out.println(&quot;后置通知&quot;);
	}
	
	@AfterThrowing(&quot;com.sugar.Demo.demo1()&quot;)
	public void myThrows() {
		System.out.println(&quot;异常通知&quot;);
	}

	@Around(&quot;com.sugar.Demo.demo1()&quot;)
	public Object myArround(ProceedingJoinPoint p) throws Throwable {
		System.out.println(&quot;环绕-前置&quot;);
		Object result = p.proceed();
		System.out.println(&quot;环绕-后置&quot;);
		return result;
	}
}
</code></pre>

<h1 id="九-自动注入">九、自动注入</h1>

<p>在Spring配置文件那种对象名和ref=&ldquo;id&rdquo; id名相同使用自动注入，可以不用配置<code>&lt;property/&gt;</code></p>

<h2 id="配置的两种方式">配置的两种方式</h2>

<ul>
<li>在<code>&lt;bean/&gt;</code>中通过autowire=&ldquo;&ldquo;配置，只对<code>&lt;bean/&gt;</code>生效</li>
<li>在<code>&lt;beans/&gt;</code>中通过default-autowire=&ldquo;&ldquo;配置，表示当前配置文件中所有bean都是全局配置内容</li>
</ul>

<h2 id="autowire可取值">autowire可取值</h2>

<ul>
<li>default，默认值，根据全局default-autowire=&ldquo;&ldquo;的值，默认全局和局部都没有配置的情况，相当于no</li>
<li>no，不自动注入</li>
<li>byName，通过名称自动注入，在Spring容器中找到类的id</li>

<li><p>byType，根据类型注入</p>

<ul>
<li>Spring容器中不可以出现两个相同类型的<code>&lt;bean/&gt;</code></li>
</ul></li>

<li><p>constructor，根据构造器注入</p>

<ul>
<li>提供对应参数的构造方法（构造方法参数包括注入对象）</li>
<li>底层使用byName，构造方法参数名和其他<code>&lt;bean/&gt;</code>的id相同</li>
</ul></li>
</ul>

<h1 id="十-spring中加载properties文件">十、Spring中加载properties文件</h1>

<h2 id="1-在src下新建xx-properties文件">1. 在src下新建xx.properties文件</h2>

<h2 id="2-在spring配置文件中引入xmlns-context-在下面添加">2. 在Spring配置文件中引入xmlns:context，在下面添加</h2>

<pre><code class="language-xml">&lt;context:property-placeholder location=&quot;classpath:db.properties&quot;/&gt;
</code></pre>

<h2 id="3-添加属性文件记载-并且在-beans-中注意开启自动注入注意的地方">3. 添加属性文件记载，并且在<code>&lt;beans/&gt;</code>中注意开启自动注入注意的地方</h2>

<ul>
<li>SqlSessionFactoryBean的id不能叫做sqlSessionFactory</li>
<li>修改，把原来通过ref引用替换成value值，自动注入只会影响ref，不会影响value赋值</li>
</ul>

<pre><code class="language-xml">&lt;bean class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt;
    &lt;property name=&quot;sqlSessionFactoryBeanName&quot; value=&quot;factory&quot;&gt;&lt;/property&gt;
    &lt;property name=&quot;basePackage&quot; value=&quot;com.sugar.mapper&quot;&gt;&lt;/property&gt;
&lt;/bean&gt;
</code></pre>

<h2 id="4-在被spring管理的类中通过-value-key-取出properties中的内容">4.在被Spring管理的类中通过@Value(&ldquo;${key}&rdquo;)取出properties中的内容</h2>

<ul>
<li>添加注解扫描</li>
</ul>

<pre><code class="language-xml">&lt;context:component-scan base-package=&quot;com.sugar&quot;&gt;&lt;/context:component-scan&gt;
</code></pre>

<ul>
<li>方式一、在类中添加

<ul>
<li>key和变量名可以不同</li>
<li>变量类型为任意类型，只要保证key对应的value能转换成此类型</li>
</ul></li>
</ul>

<pre><code class="language-java">@Value(&quot;${my.demo}&quot;)
private String test;
</code></pre>

<ul>
<li>方式二、 配置文件中</li>
</ul>

<pre><code class="language-xml">&lt;property name=&quot;test&quot; value=&quot;${my.demo}&quot;&gt;&lt;/property&gt;
</code></pre>

<h1 id="十一-scope属性">十一、scope属性</h1>

<p><code>&lt;bean/&gt;</code>的属性</p>

<h2 id="作用控制对象有效范围-单例-多例等">作用控制对象有效范围（单例、多例等）</h2>

<h2 id="bean-对应的默认值都是单例的"><code>&lt;bean/&gt;</code>对应的默认值都是单例的</h2>

<ul>
<li>无论获取多少次都是同一个对象</li>
</ul>

<h2 id="scope可取值">scope可取值</h2>

<ul>
<li>singleton，默认值，单例</li>
<li>prototype，多例，每次获取重新实例化</li>
<li>request，每次请求重新实例化</li>
<li>session，每个会话对象</li>
<li>application，在application对象内是单例</li>
<li>global session spring 推出的一个对象，依赖于spring-webmvc-portlet，类似于session</li>
</ul>

<h1 id="十二-声明式事务">十二、声明式事务</h1>

<h2 id="编程式事务">编程式事务</h2>

<ul>
<li>由程序员编程事务控制代码</li>
<li>OpenSessionInView 编程式事务</li>
</ul>

<h2 id="声明式事务">声明式事务</h2>

<ul>
<li>事务控制代码已经由Spring写好，程序员只需要声明出哪些方法需要进行事务控制和如何进行事务控制</li>
</ul>

<h2 id="声明式事务都是针对于serviceimpl类下方法的">声明式事务都是针对于ServiceImpl类下方法的</h2>

<h2 id="事务管理器基于通知-advice">事务管理器基于通知（advice）</h2>

<h2 id="在spring配置文件中配置声明式事务">在spring配置文件中配置声明式事务</h2>

<pre><code class="language-xml">&lt;context:property-placeholder location=&quot;classpath:db.properties&quot;/&gt;
	
&lt;bean id=&quot;dataSource&quot; class=&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;&gt;
    &lt;property name=&quot;driverClassName&quot; value=&quot;${jdbc.driver}&quot;&gt;&lt;/property&gt;
    &lt;property name=&quot;url&quot; value=&quot;${jdbc.url}&quot;&gt;&lt;/property&gt;
    &lt;property name=&quot;username&quot; value=&quot;${jdbc.username}&quot;&gt;&lt;/property&gt;
    &lt;property name=&quot;password&quot; value=&quot;${jdbc.password}&quot;&gt;&lt;/property&gt;
&lt;/bean&gt;

&lt;!-- spring-jdbc.jar中 --&gt;
&lt;bean id=&quot;txManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;
    &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;&gt;&lt;/property&gt;
&lt;/bean&gt;

&lt;!-- 配置声明式事务 --&gt;
&lt;tx:advice id=&quot;txAdvice&quot; transaction-manager=&quot;txManager&quot;&gt;
    &lt;tx:attributes&gt;
        &lt;!-- 哪些方法需要有事务控制 --&gt;
        &lt;!-- 方法以ins开头事务管理 --&gt;
        &lt;tx:method name=&quot;ins*&quot;/&gt;
        &lt;tx:method name=&quot;del*&quot;/&gt;
        &lt;tx:method name=&quot;upd*&quot;/&gt;
        &lt;tx:method name=&quot;*&quot;/&gt;
    &lt;/tx:attributes&gt;
&lt;/tx:advice&gt;

&lt;aop:config&gt;
    &lt;!-- 切点范围放大一些 --&gt;
    &lt;aop:pointcut expression=&quot;execution(* com.sugar.service.impl.*.*(..))&quot; id=&quot;mypoint&quot;/&gt;
    &lt;aop:advisor advice-ref=&quot;txAdvice&quot; pointcut-ref=&quot;mypoint&quot;/&gt;
&lt;/aop:config&gt;
</code></pre>

<h2 id="声明式事务属性解释">声明式事务属性解释</h2>

<ul>
<li><p>name=&ldquo;&rdquo; ，哪些方法需要有事务控制，支持*通配符</p></li>

<li><p>readonly=&ldquo;boolean&rdquo;，是否只读事务</p>

<ul>
<li>true，告诉数据库此事务为只读事务，数据库优化会对性能有所提升，所以只要是查询的方法，建议用此事务</li>
<li>false，默认值，事务需要提交的事务，建议新增、删除、修改
<br /></li>
</ul></li>

<li><p>propagation=&ldquo;&ldquo;，控制事务传播行为，当一个具有事务控制的方法被另一个有事务控制的方法调用后，需要如何管理事务（新建事务？在事务中执行？把事务挂起？报异常？）</p>

<ul>
<li>REQUIRED，默认值，如果当前有事务，就在当前事务执行，如果当前没有事务，就新建一个事务</li>
<li>SUPPORTS， 如果当前有事务，就在当前事务执行，如果当前没有事务，就在非事务状态下执行</li>
<li>MANDATORY，必须在事务内部执行， 如果当前有事务，就在当前事务执行，如果当前没有事务，报错</li>
<li>REQUIRES_NEW，必须在事务内部执行， 如果当前有事务，就把当前事务挂起，如果当前没有事务，就新建一个事务</li>

<li><p>NOT_SUPPORTED，必须在非事务下执行，如果当前有事务就挂起，如果当前没有事务，正常执行</p></li>

<li><p>NEVER，必须在非事务下执行，如果当前有事务就报异常，如果当前没有事务，正常执行</p></li>

<li><p>NESTED，必须在事务内部执行，如果当前有事务，就创建一个嵌套事务，如果没有事务，新建一个事务</p></li>
</ul></li>

<li><p>isolation=&ldquo;&ldquo;，事务隔离级别，在多线程或并发访问下如何保证访问到的数据具有完整性</p>

<ul>
<li>脏读，个事务（A）读取到另一个事务（B）中未提交的数据，另一个事务中数据可能进行了改变，此时事务（A）读取的数据可能和数据库中的数据不一致，此时任务数据是脏数据，读取脏数据的过程叫做脏读。</li>
<li>不可重复读，主要针对的是某行数据（或行中某列），主要针对操作时修改操作，两次读取在同一事务内，当事务（A）第一次读取事务后，事务（B）对事务（A）读取的数据进行了修改，事务（A）再次读取数据和之前读取过的数据不一致，过程不可重复。</li>
<li>幻读，主要针对的操作是新增或删除，两次事务的结果，事务（A）按照特定条件查询出结果，事务（B）新增一条符合条件的数据。事务（A）中查询的数据和数据库中的数据不一致，事务（A）好像出现了幻觉，这种情况称之为幻读。</li>
<li>DEFAULT，默认值，由底层数据库自动判断使用什么隔离级别。</li>
<li>READ_UNCOMMITTED，可以读取未提交数据，可能出现脏读、不可重复读、幻读。效率最高</li>
<li>READ_COMMITTED，只能读取其他事务已提交数据，可以防止脏读，可能出现不可重复读、幻读。</li>
<li>REPEATABLE_READ，读取的数据会被添加锁，防止其他事物修改此数据，可以防止不可重复读、脏读，可能出现幻读。</li>
<li>SERIALIZABLE，排队操作，对整个表添加锁，一个事务在操作数据时，另一个事务需要等待事务操作完成后，才能操作这个表。最安全，效率最低。</li>
</ul></li>

<li><p>rollback-for=&ldquo;&ldquo;，异常类型全限定路径，当出现什么异常时需要进行回滚</p>

<ul>
<li>建议给定该属性值，手动抛异常一定要给该属性值</li>
</ul></li>

<li><p>no-rollback-for=&ldquo;&ldquo;，当出现什么异常时，不会滚事务。</p></li>
</ul>

<h1 id="十三-spring常用注解">十三、Spring常用注解</h1>

<p><strong>1. @Component，创建类对象，相当于配置<code>&lt;bean/&gt;</code></strong></p>

<p><strong>2. @Service和@Component功能相同，写在ServiceImpl上</strong></p>

<p><strong>3. @Repository与@Component功能相同，写在数据访问层上</strong></p>

<p><strong>4. @Controller与@Component功能相同，写在控制器上</strong></p>

<p><strong>5. @Resource（不需要写对象get/set）</strong></p>

<ul>
<li>Java中的注解</li>
<li>默认按照byName注入，如果没有名称对象，按照byType注入</li>
<li>建议把对象名称和spring容器中对象名相同</li>
</ul>

<p><strong>6. @Autowired（不需要写对象get/set）</strong></p>

<ul>
<li>Spring的注解</li>
<li>默认按照byType注入</li>
</ul>

<p><strong>7. @Value()获取properties文件中内容</strong></p>

<p><strong>8. @PointCut()定义切点</strong></p>

<p><strong>9. @Aspect()定义切面类</strong></p>

<p><strong>10. @Before()前置通知</strong></p>

<p><strong>11. @After()后置通知</strong></p>

<p><strong>12. @AfterReturning()必须切点正确执行</strong></p>

<p><strong>13. @AfterThrowing()异常通知</strong></p>

<p><strong>14. @Around()环绕通知</strong></p>

<h1 id="十四-web-xml加载spring配置文件">十四、web.xml加载Spring配置文件</h1>

<pre><code class="language-xml">	&lt;!-- 上下文参数 --&gt;
	&lt;context-param&gt;
		&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
		&lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt;
	&lt;/context-param&gt;
	&lt;listener&gt;
		&lt;!-- 加载监听器时会创建WebApplicationContext --&gt;
		&lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;
	&lt;/listener&gt;
</code></pre>

        </div>
        <footer class="article-footer">
    <a data-url="https://sugarstar88.github.io/2020/06/11/spring/" data-id="7845972fcf05a92a13cc550b6b13dbea" class="article-share-link">
        <i class="fa fa-share"></i>
        分享
    </a>
    
    <a href="https://sugarstar88.github.io/2020/06/11/spring/#disqus_thread" class="article-comment-link">
        评论
    </a>
    

    <script>
    (function ($) {
        
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
    </script>
</footer>

    </div>

    
<nav id="article-nav">
    

    
    <a href="https://sugarstar88.github.io/2020/06/11/springmvc/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">
          上一篇
      </strong>
      <div class="article-nav-title">SpringMVC</div>
    </a>
    
</nav>


</article>


<section id="comments">
    <div id="disqus_thread">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "spf13" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
</section>


    </section>

   	
    	<aside id="sidebar">
    
<div class="widget-wrap">
    <h3 class="widget-title">
        最新文章
    </h3>
    <div class="widget">
        <ul id="recent-post">
            
            <li>
                <div class="item-thumbnail">
                    <a href="https://sugarstar88.github.io/2020/06/11/mybatis/" class="thumbnail">
                    
                        <span class="thumbnail-image thumbnail-none"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-title"><a href="https://sugarstar88.github.io/2020/06/11/mybatis/" class="title">MyBatis</a></p>
                    <p class="item-date">
                        <time datetime="2020-06-11 15:30:12 &#43;0800 CST" itemprop="datePublished">2020-06-11</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="https://sugarstar88.github.io/2020/06/11/springmvc/" class="thumbnail">
                    
                        <span class="thumbnail-image thumbnail-none"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-title"><a href="https://sugarstar88.github.io/2020/06/11/springmvc/" class="title">SpringMVC</a></p>
                    <p class="item-date">
                        <time datetime="2020-06-11 15:29:12 &#43;0800 CST" itemprop="datePublished">2020-06-11</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="https://sugarstar88.github.io/2020/06/11/spring/" class="thumbnail">
                    
                        <span class="thumbnail-image thumbnail-none"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    <p class="item-title"><a href="https://sugarstar88.github.io/2020/06/11/spring/" class="title">Spring</a></p>
                    <p class="item-date">
                        <time datetime="2020-06-11 15:17:12 &#43;0800 CST" itemprop="datePublished">2020-06-11</time>
                    </p>
                </div>
            </li>
            
        </ul>
    </div>
</div>


    





    





    






    <div id="toTop" class="fa fa-angle-up"></div>
</aside>

    
	</div>
</div>

<footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020
      Powered by <a href="https://github.com/SugarStars">SugarStar</a>.
    </div>
  </div>
</footer>


<script src="https://sugarstar88.github.io/fancybox/jquery.fancybox.pack.js"></script>
<script src="https://sugarstar88.github.io/js/script.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>


<script>hljs.initHighlightingOnLoad();</script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>




</body>
</html>